# Security Policy

## Reporting a Vulnerability

**Please do NOT create public GitHub issues for security vulnerabilities.** Instead, we ask that you responsibly disclose the vulnerability by emailing us at **security@configjs.dev** (or use GitHub's private vulnerability disclosure feature).

### What to Include

When reporting a security vulnerability, please provide:

1. **Type of vulnerability** (e.g., injection, buffer overflow, authentication bypass)
2. **Location** (file, line number, or function name)
3. **Description** (what the vulnerability is and why it matters)
4. **Proof of Concept (PoC)** (minimal code example demonstrating the issue)
5. **Severity** (critical, high, medium, low)
6. **Affected versions** (which release versions are affected)

### Example Report

```
Subject: Security Vulnerability in ConfigJS v1.x - Command Injection

Hello,

I discovered a command injection vulnerability in the `package-manager.ts` file.

Location: src/utils/package-manager.ts, line 45

Vulnerability: The npm command is constructed using unsanitized user input,
allowing attackers to inject arbitrary npm flags.

PoC:
  configjs install "axios; npm cache clean --force"

This could allow an attacker to:
  - Execute arbitrary npm commands
  - Modify the user's npm cache
  - Potentially install malicious packages

Affected versions: v1.0.0 - v1.3.0

Severity: High
```

---

## Responsible Disclosure Timeline

We follow a 90-day coordinated disclosure window:

| Days | Action |
|------|--------|
| **Day 0** | Vulnerability reported to security team |
| **Day 1-3** | We acknowledge receipt and assess severity |
| **Day 7** | We provide initial timeline for patch |
| **Day 30** | Patch is typically developed and reviewed |
| **Day 45-60** | Patch is released (usually in next minor/patch version) |
| **Day 90** | Public disclosure is permissible if patch released |

### If We Miss Deadline

If ConfigJS team cannot provide a patch by Day 90:
- The reporter may disclose publicly after good faith notice
- We'll acknowledge the vulnerability and provide a timeline for remediation
- We'll work with you to find an acceptable disclosure date

---

## Scope

### ‚úÖ In Scope

Security vulnerabilities that affect ConfigJS CLI and can compromise:

- **Input Validation & Injection Prevention**
  - Command injection (npm args, shell commands)
  - Path traversal attacks
  - Code injection in generated templates
  - Environment variable injection

- **Authentication & Authorization**
  - Token/credential leakage in logs
  - Unsafe credential handling
  - Insecure credential storage in config files

- **Cryptography & Secrets**
  - Hardcoded secrets or API keys
  - Weak random number generation
  - Insecure key derivation

- **Denial of Service**
  - Resource exhaustion (excessive memory, CPU)
  - Infinite loops in dependency resolution
  - Uncontrolled recursion

- **Dependency Security**
  - Known vulnerabilities in dependencies (CVEs)
  - Supply chain attacks
  - Malicious transitive dependencies

- **File System Operations**
  - Symlink race conditions
  - Insecure temporary file handling
  - Unsafe file permissions
  - Time-of-check-time-of-use (TOCTOU) bugs

### ‚ùå Out of Scope

Security issues that **do NOT** affect ConfigJS directly:

- **Generated Code Quality** ‚Äî Vulnerabilities in code templates generated by ConfigJS
  - *Reason:* The end-user (developer) is responsible for reviewing and securing generated code
  - *Exception:* If the template has a known dangerous pattern that ConfigJS actively teaches
  
- **Third-Party Framework Vulnerabilities** ‚Äî React, Vue, Next.js, etc. vulnerabilities
  - *Reason:* These are maintained by their respective teams
  - *Action:* Report to the framework maintainers
  
- **DevDependency Vulnerabilities** (unless critical)
  - *Reason:* Dev tools don't affect production code
  - *Exception:* If a dev tool vulnerability allows code execution during setup
  
- **User Configuration Errors** ‚Äî Insecure user choices after setup
  - *Example:* User adds `--no-verify` to git hooks, enabling pre-commit bypass
  - *Exception:* If ConfigJS actively enables this by default

- **Social Engineering** ‚Äî Phishing, pretexting, etc.

- **Physical Security** ‚Äî Hardware, infrastructure, etc.

---

## Security Update Policy

### Release Cadence

- **Critical Vulnerabilities (CVE CVSS ‚â• 9.0):** Patched within 24 hours, emergency release
- **High Vulnerabilities (CVE CVSS 7.0-8.9):** Patched within 7 days, patch release
- **Medium Vulnerabilities (CVE CVSS 4.0-6.9):** Patched in next scheduled release
- **Low Vulnerabilities (CVE CVSS < 4.0):** Patched in next scheduled release

### Communication

- **GitHub Security Advisory** ‚Äî Published when patch is released
- **CHANGELOG** ‚Äî All security fixes documented with date and severity
- **Releases Page** ‚Äî Tagged as `security` for easy filtering

---

## Security Best Practices for Users

ConfigJS is secure by default, but we recommend users follow these practices:

### 1. Keep ConfigJS Updated

```bash
npm install -g @configjs/cli@latest
```

### 2. Review Generated Code

ConfigJS generates framework templates and configuration files. Always:
- Review generated code before committing
- Understand what each file does
- Modify based on your security requirements

### 3. Secure Your npm Credentials

Store npm tokens securely:
```bash
# ‚ùå NEVER do this:
npm config set //registry.npmjs.org/:_authToken="token123"

# ‚úÖ Use environment variable instead:
export NPM_TOKEN="your_token"
npm config set //registry.npmjs.org/:_authToken="${NPM_TOKEN}"
```

### 4. Use Lock Files

Always commit `package-lock.json` or `yarn.lock`:
```bash
git add package-lock.json
git commit -m "lock: secure dependency versions"
```

### 5. Audit Dependencies Regularly

```bash
npm audit
npm audit fix
```

---

## Previous Security Issues

### Phase 1 Security (v1.3.1 - Jan 2026)

| ID | Title | Severity | Fixed | Details |
|---|-------|----------|-------|---------|
| SEC-001 | NPM Argument Injection | üî¥ Critical | ‚úÖ v1.3.1 | Validate npm arguments with whitelist |
| SEC-002 | Environment Variable Leakage | üî¥ Critical | ‚úÖ v1.3.1 | Filter process.env to safe variables |
| SEC-003 | Sensitive Data in Logs | üî¥ Critical | ‚úÖ v1.3.1 | Scrub logs for tokens, passwords, keys |
| SEC-004 | Package Version Injection | üü† High | ‚úÖ v1.3.1 | Validate package@version format |
| SEC-005 | Additional Argument Injection | üü† High | ‚úÖ v1.3.1 | Validate all CLI arguments |

---

## Contact

- **Security Email:** security@configjs.dev
- **GitHub Issues:** For non-security bugs only
- **GitHub Discussions:** For questions and feature requests

---

## Credits

We gratefully acknowledge security researchers who responsibly report vulnerabilities. With permission, we'll credit you in the CHANGELOG and GitHub Security Advisory.

---

**Last Updated:** January 22, 2026  
**Policy Version:** 1.0  
**Maintained by:** ConfigJS Security Team
